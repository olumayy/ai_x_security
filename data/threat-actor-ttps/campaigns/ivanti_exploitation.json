{
  "id": "ivanti-exploitation-2024",
  "name": "Ivanti Connect Secure Mass Exploitation",
  "threat_actors": ["Multiple - Nation-state and criminal"],
  "classification": "mass_exploitation",
  "timeframe": {
    "initial_exploitation": "2023-12",
    "public_disclosure": "2024-01-10",
    "patch_released": "2024-01-31",
    "emergency_directive": "2024-01-19"
  },
  "summary": "Multiple threat actors, including suspected Chinese state-sponsored groups (UNC5221/UTA0178), mass-exploited zero-day vulnerabilities in Ivanti Connect Secure and Policy Secure VPN appliances. The campaign affected thousands of organizations globally and prompted CISA to issue an emergency directive requiring federal agencies to disconnect vulnerable devices.",
  "vulnerabilities": [
    {
      "cve": "CVE-2023-46805",
      "type": "Authentication bypass",
      "cvss": 8.2,
      "description": "Authentication bypass in web component"
    },
    {
      "cve": "CVE-2024-21887",
      "type": "Command injection",
      "cvss": 9.1,
      "description": "Command injection in web component"
    },
    {
      "cve": "CVE-2024-21893",
      "type": "Server-side request forgery",
      "cvss": 8.2,
      "description": "SSRF in SAML component"
    },
    {
      "cve": "CVE-2024-22024",
      "type": "XXE",
      "cvss": 8.3,
      "description": "XML external entity vulnerability"
    }
  ],
  "attack_phases": [
    {
      "phase": 1,
      "name": "Vulnerability Chaining",
      "techniques": ["T1190"],
      "description": "Attackers chained CVE-2023-46805 and CVE-2024-21887 to achieve unauthenticated remote code execution on vulnerable Ivanti appliances.",
      "exploitation_method": "Authentication bypass + command injection chain"
    },
    {
      "phase": 2,
      "name": "Web Shell Deployment",
      "techniques": ["T1505.003"],
      "description": "Deployed various web shells including LIGHTWIRE, WIREFIRE, CHAINLINE, and FRAMESTING for persistent access.",
      "indicators": [
        "Web shell files in Ivanti directories",
        "Modified legitimate Ivanti files",
        "Unusual HTTP POST requests"
      ]
    },
    {
      "phase": 3,
      "name": "Credential Harvesting",
      "techniques": ["T1003", "T1555"],
      "description": "Harvested credentials from VPN sessions, cached credentials, and configuration databases.",
      "indicators": [
        "Access to credential caches",
        "Configuration file access",
        "Session data extraction"
      ]
    },
    {
      "phase": 4,
      "name": "Lateral Movement to Internal Networks",
      "techniques": ["T1021", "T1078"],
      "description": "Used harvested credentials and VPN access to move into internal networks.",
      "indicators": [
        "VPN connections from compromised appliances",
        "Internal network reconnaissance",
        "Credential reuse"
      ]
    },
    {
      "phase": 5,
      "name": "Persistence via Integrity Bypass",
      "techniques": ["T1601.001"],
      "description": "Attackers modified Ivanti's internal integrity checker to hide malicious modifications, allowing web shells to survive reboots and even factory resets in some cases.",
      "indicators": [
        "Modified integrity checking scripts",
        "Persistent web shells",
        "Firmware-level modifications"
      ]
    }
  ],
  "web_shells_deployed": [
    {
      "name": "LIGHTWIRE",
      "type": "Perl CGI",
      "capabilities": "Command execution, file operations"
    },
    {
      "name": "WIREFIRE",
      "type": "Python",
      "capabilities": "Download/execute, command execution"
    },
    {
      "name": "CHAINLINE",
      "type": "Perl",
      "capabilities": "Command execution, tunneling"
    },
    {
      "name": "FRAMESTING",
      "type": "Python",
      "capabilities": "Command execution via web requests"
    },
    {
      "name": "BUSHWALK",
      "type": "Perl",
      "capabilities": "File read/write, command execution"
    }
  ],
  "threat_actor_attribution": {
    "unc5221_uta0178": {
      "attribution": "Suspected Chinese state-sponsored",
      "activity": "Early exploitation, espionage focus",
      "targets": "Government, defense, critical infrastructure"
    },
    "other_actors": {
      "description": "Multiple criminal and nation-state actors joined exploitation",
      "activity": "Ransomware, cryptomining, further compromise"
    }
  },
  "impact": {
    "devices_vulnerable": "Thousands globally",
    "sectors_affected": [
      "Government",
      "Defense",
      "Healthcare",
      "Finance",
      "Critical infrastructure"
    ],
    "cisa_emergency_directive": "ED-24-01 requiring federal disconnect and rebuild"
  },
  "detection_and_response": {
    "ioc_locations": [
      "/api/v1/totp/user-backup-code",
      "Modified compcheckresult.cgi",
      "Unusual files in /home/webserver/htdocs/"
    ],
    "detection_methods": [
      "Ivanti Integrity Checker Tool (ICT) - but can be bypassed",
      "External vulnerability scanning",
      "Network traffic analysis for web shell activity",
      "Log analysis for exploitation attempts"
    ],
    "recommended_actions": [
      "Factory reset is not sufficient - rebuild required",
      "Rotate all credentials that traversed the VPN",
      "Hunt for lateral movement in internal networks",
      "Monitor for credential abuse"
    ]
  },
  "lessons_learned": [
    "VPN appliances are high-value targets",
    "Zero-days in network edge devices are devastating",
    "Integrity checking can be subverted",
    "Factory reset may not remove sophisticated implants",
    "Credential rotation after compromise is critical",
    "Network edge device security requires special attention"
  ],
  "references": [
    "https://www.cisa.gov/news-events/directives/ed-24-01-mitigate-ivanti-connect-secure-and-ivanti-policy-secure-vulnerabilities",
    "https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-060b",
    "https://www.mandiant.com/resources/blog/investigating-ivanti-exploitation"
  ]
}
